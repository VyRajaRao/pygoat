{% extends "introduction/base.html" %}
{% block content %}

<div class="content">

    <h3 style="text-align:center">
        Lab 3: Unsigned / Unverified Plugin Loading
    </h3>

    <div class="box">

        <h4>Challenge</h4>
        <p class="bp">
            This lab demonstrates a Software and Data Integrity Failure caused by
            loading plugins or updates without verifying their integrity or authenticity.
        </p>

        <h4>Scenario</h4>
        <p class="bp">
            The application supports plugins that extend its functionality. These plugins
            are loaded dynamically at runtime and are assumed to be trusted.
        </p>

        <p class="bp">
            However, no integrity checks such as digital signatures or checksums are
            performed before executing the plugin. An attacker who is able to replace
            or modify the plugin can influence application behavior.
        </p>

        <h4>Simulate Plugin Update</h4>

        <p class="bp">
            Use the buttons below to simulate how the application behaves when a
            trusted plugin is used versus when a modified plugin is loaded.
        </p>

        <div style="
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        ">
            <a href="?plugin=trusted" class="btn btn-info">
                Load Trusted Plugin
            </a>
        
            <a href="?plugin=tampered" class="btn btn-info">
                Load Modified Plugin
            </a>
        
            {% if result %}
            <a href="/2021/A8/lab3" class="btn btn-info">
                Clear Output
            </a>
            {% endif %}
        </div>


        <p class="bp">
            <strong>Currently Selected Plugin:</strong>
            {% if plugin_choice == "tampered" %}
            Modified / Tampered Plugin
            {% elif plugin_choice == "trusted" %}
            Trusted Plugin
            {% else %}
            None selected
            {% endif %}
        </p>


        <h4>Plugin Output</h4>
        <div class="box">
            {% if result %}
            {% if result.error %}
            <div class="alert alert-danger" role="alert">
                <strong>Error loading plugin:</strong> {{ result.error }}
            </div>
            {% else %}
            <ul>
                {% for key, value in result.items %}
                <li><strong>{{ key }}:</strong> {{ value }}</li>
                {% endfor %}
            </ul>
            {% endif %}
            {% else %}
            <p class="bp">No output generated.</p>
            {% endif %}
        </div>

        <h4>What to Try</h4>
        <ul>
            <li>Navigate to the plugin directory used by the application</li>
            <li>Inspect the trusted plugin file currently being loaded</li>
            <li>Modify or replace the plugin with a malicious version</li>
            <li>Reload this page and observe the change in behavior</li>
        </ul>

        <h4>Impact</h4>
        <p class="bp">
            Observe how the application continues to execute the plugin without
            detecting any integrity violation. This demonstrates how trusting
            unverified plugins or updates can lead to unauthorized code execution
            and loss of software integrity.
        </p>

    </div>
</div>

<div style="position:fixed; right:7px; bottom:7px">
    <button class="btn btn-info" type="button"
            onclick="window.location.href='/2021/A8'">
        Back to Lab Details
    </button>
</div>

{% endblock %}
